package com.ssafy.scentify.schedule.model.dto;

import java.sql.Time;
import java.util.UUID;

import com.ssafy.scentify.device.model.dto.DeviceDto.defaultCombinationDto;

import groovy.transform.ToString;
import lombok.AllArgsConstructor;
import lombok.Getter;
import lombok.NoArgsConstructor;
import lombok.Setter;

@Getter
@ToString
@NoArgsConstructor
@AllArgsConstructor
public class CustomScheduleDto {
	private Integer id;
    private String name;
    private int deviceId;
    private String userId;
    private int day; 
    private defaultCombinationDto.Combination combination;
    private Time startTime;
    private Time endTime;
    private int interval;
    private boolean modeOn;
    
	public void setId(Integer id) {
		this.id = id;
	}
    
    public void setName(String name) {
        if (name == null || name.length() < 1 || name.length() > 30) {
            throw new IllegalArgumentException("입력값이 형식에 맞지 않습니다.");
        }
        this.name = name;
    }

    public void setDeviceId(int deviceId) {
        this.deviceId = deviceId;
    }
    
    
    public void setUserId(String userId) {
        if (userId == null || userId.isBlank() || userId.contains(" ") || userId.length() > 30) {
            throw new IllegalArgumentException("입력값이 형식에 맞지 않습니다.");
        }
        this.userId = userId;
    }
    
    public void setDay(int day) {
        if (day < 0 || day > 0b1111111) { // 7비트 이내 값이어야 함 (0 ~ 127)
            throw new IllegalArgumentException("입력값이 형식에 맞지 않습니다.");
        }
        this.day = day;
    }

    public void setStartTime(Time startTime) {
        if (startTime == null) {
            throw new IllegalArgumentException("입력값이 형식에 맞지 않습니다.");
        }
        this.startTime = startTime;
    }

    public void setEndTime(Time endTime) {
        if (endTime == null) {
            throw new IllegalArgumentException("입력값이 형식에 맞지 않습니다.");
        }
        if (this.startTime != null && endTime.before(this.startTime)) {
            throw new IllegalArgumentException("endTime은 startTime 이후여야 합니다.");
        }
        this.endTime = endTime;
    }

    public void setInterval(int interval) {
        if (interval < 0) {
            throw new IllegalArgumentException("입력값이 형식에 맞지 않습니다.");
        }
        this.interval = interval;
    }

	public void setModeOn(boolean modeOn) {
		this.modeOn = modeOn;
	}
	
	@Getter
    @AllArgsConstructor
    public static class Combination {
    	private String name;
        private int choice1; // NOT NULL
        @Setter
        private int choice1Count;
        private Integer choice2; // NULL 허용
        @Setter
        private Integer choice2Count;
        private Integer choice3; // NULL 허용
        @Setter
        private Integer choice3Count;
        private Integer choice4; // NULL 허용
        @Setter
        private Integer choice4Count;
        
        public void setName(String name) {
            if ((name != null && name.isBlank()) || (name != null && name.length() > 15)) {
                throw new IllegalArgumentException("입력값이 형식에 맞지 않습니다.");
            }
            this.name = name;
        }

        public void setChoice1(int choice1) {
            if (choice1 < 0 || choice1 > 8) {
                throw new IllegalArgumentException("입력값이 형식에 맞지 않습니다.");
            }
            this.choice1 = choice1;
        }

        public void setChoice2(Integer choice2) {
            if (choice2 != null && (choice2 < 0 || choice2 > 8)) {
                throw new IllegalArgumentException("입력값이 형식에 맞지 않습니다.");
            }
            this.choice2 = choice2;
        }

        public void setChoice3(Integer choice3) {
            if (choice3 != null && (choice3 < 0 || choice3 > 8)) {
                throw new IllegalArgumentException("입력값이 형식에 맞지 않습니다.");
            }
            this.choice3 = choice3;
        }

        public void setChoice4(Integer choice4) {
            if (choice4 != null && (choice4 < 0 || choice4 > 8)) {
                throw new IllegalArgumentException("입력값이 형식에 맞지 않습니다.");
            }
            this.choice4 = choice4;
        }
}
