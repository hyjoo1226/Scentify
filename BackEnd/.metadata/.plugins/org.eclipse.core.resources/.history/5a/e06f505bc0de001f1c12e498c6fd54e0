package com.ssafy.scentify.schedule.model.repository;

import java.util.List;

import org.apache.ibatis.annotations.*;
import com.ssafy.scentify.home.model.dto.HomeDto;
import com.ssafy.scentify.home.model.dto.HomeDto.CustomScheduleHomeDto;
import com.ssafy.scentify.schedule.model.dto.CustomScheduleDto;

@Mapper
public interface CustomScheduleRepository {
	
	// 디바이스 아이디로 스케줄 조회
	@Select("SELECT id, name, combination_id, combination_name, is_favorite, day, start_time, end_time, `interval` "
	          + "FROM customschedule WHERE device_id = #{deviceId}")
    @Results({
        @Result(column = "id", property = "id"),
        @Result(column = "name", property = "name"),
        @Result(column = "combination_id", property = "combinationId"),
        @Result(column = "combination_name", property = "combinationName"),
        @Result(column = "is_favorite", property = "isFavorite"),
        @Result(column = "day", property = "day"),
        @Result(column = "start_time", property = "startTime"),
        @Result(column = "end_time", property = "endTime"),
        @Result(column = "interval", property = "interval")
    })
    List<CustomScheduleHomeDto> getSchedulesByDeviceId(int deviceId);
	
	@Insert("""
		    INSERT INTO custom_schedule 
		    (name, device_id, user_id, day, combination_id, start_time, end_time, interval, mode_on) 
		    VALUES 
		    (#{customScheduleDto.name}, #{customScheduleDto.deviceId}, #{customScheduleDto.userId}, 
		     #{customScheduleDto.day}, #{combinationId}, #{customScheduleDto.startTime}, 
		     #{customScheduleDto.endTime}, #{customScheduleDto.interval}, #{customScheduleDto.modeOn})
		""")
	boolean createCustomSchedule(@Param("customSchedule") CustomScheduleDto customScheduleDto, Integer combinationId, String name);
}
