package com.ssafy.scentify.device;

import java.util.List;

import org.springframework.stereotype.Service;

import com.ssafy.scentify.device.model.dto.DeviceDto.CapsuleInfo;
import com.ssafy.scentify.device.model.dto.DeviceDto.DeviceInfoDto;
import com.ssafy.scentify.device.model.dto.DeviceDto.RegisterDto;
import com.ssafy.scentify.device.model.repository.DeviceRepository;
import com.ssafy.scentify.user.model.repository.UserRepository;
import com.ssafy.scentify.websocket.model.dto.WebSocketDto.CapsuleRemainingRequest;
import com.ssafy.scentify.websocket.model.dto.WebSocketDto.TempHumRequest;

@Service
public class DeviceService {
	private final UserRepository userRepository;
	private final DeviceRepository deviceRepository;
	
	public DeviceService(UserRepository userRepository, DeviceRepository deviceRepository) {
		this.userRepository = userRepository;
		this.deviceRepository = deviceRepository;
	}
	
	public boolean selectDeviceBySerial(String Serial) {
		return deviceRepository.existsBySerial(Serial) ? true : false;
	}
	
	public String selectSerialByDeviceId(Integer id) {
		return deviceRepository.getSerialByDeviceId(id);
	}

	public boolean createDevice(RegisterDto registerDto) {
		if (!deviceRepository.createDevice(registerDto)) return false;
		userRepository.updateMainDeviceId(registerDto.getAdminId(), registerDto.getId());
		return true;
	}

	public boolean updateCapsuleInfo(CapsuleInfo capsuleInfo) {
		return deviceRepository.updateCapsueInfo(capsuleInfo) ? true : false;
	}

	public boolean updateDefalutCombination(Integer id, Integer roomType, Integer combinationId) {
		return deviceRepository.updateDefalutCombination(id, roomType, combinationId) ? true : false;
	}

	public List<DeviceInfoDto> findDevicesByIds(List<Integer> deviceIds) {
		return deviceRepository.selectDevicesByIds(deviceIds);
	}

	public boolean updateTempHum(String serial, TempHumRequest request) {
		return deviceRepository.updateTempHum(serial, request);
	}

	public boolean updateCapsuleRemaining(String serial, CapsuleRemainingRequest request) {
		return deviceRepository.updateCapsuleRemaining(serial, request);	
	}

	public boolean updateGroupId(Integer id, Integer groupId) {
		// TODO Auto-generated method stub
		
	}
}
