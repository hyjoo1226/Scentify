<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ssafy.scentify.group.model.repository.GroupRepository">
	<update id="updateMember">
    UPDATE `group`
    <set>
        member_1_id = IF(member_1_id IS NULL, #{memberId}, member_1_id),
        member_1_nickname = IF(member_1_id IS NULL, #{memberNickname}, member_1_nickname),
        member_2_id = IF(member_1_id IS NOT NULL AND member_2_id IS NULL, #{memberId}, member_2_id),
        member_2_nickname = IF(member_1_id IS NOT NULL AND member_2_id IS NULL, #{memberNickname}, member_2_nickname),
        member_3_id = IF(member_1_id IS NOT NULL AND member_2_id IS NOT NULL AND member_3_id IS NULL, #{memberId}, member_3_id),
        member_3_nickname = IF(member_1_id IS NOT NULL AND member_2_id IS NOT NULL AND member_3_id IS NULL, #{memberNickname}, member_3_nickname),
        member_4_id = IF(member_1_id IS NOT NULL AND member_2_id IS NOT NULL AND member_3_id IS NOT NULL AND member_4_id IS NULL, #{memberId}, member_4_id),
        member_4_nickname = IF(member_1_id IS NOT NULL AND member_2_id IS NOT NULL AND member_3_id IS NOT NULL AND member_4_id IS NULL, #{memberNickname}, member_4_nickname)
    </set>
    WHERE id = #{id}
      AND (
        (member_1_id IS NULL) OR 
        (member_2_id IS NULL AND member_1_id IS NOT NULL) OR 
        (member_3_id IS NULL AND member_1_id IS NOT NULL AND member_2_id IS NOT NULL) OR 
        (member_4_id IS NULL AND member_1_id IS NOT NULL AND member_2_id IS NOT NULL AND member_3_id IS NOT NULL)
      );
</update>

</mapper>


